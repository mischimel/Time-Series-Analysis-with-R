---
title: "Time Series Analysis with R Part 2, Lecture 6"
author: "Michèle Fille"
format: pdf
prefer-html: true
editor: visual
toc: true
toc-depth: 4
error: false
warning: true
---

# Lecture 6 – Basic Tools and Models

## 6.1 Time Series Decomposition

### Exercise 6.1. Time Series Decomposition

#### Exercise 6.1: Transformations and Adjustments

1\) For each of the following series, make a graph of the data. If transforming seems appropriate, do so and describe the effect.

-   United States GDP from global_economy.

-   Slaughter of Victorian “Bulls, bullocks and steers” in aus_livestock.

-   Victorian Electricity Demand from vic_elec.

-   Gas production from aus_production.

2\) Why is a Box-Cox transformation unhelpful for the canadian_gas data?

3\) Show that a 3×5 MA is equivalent to a 7-term weighted moving average with weights of 0.067, 0.133, 0.200, 0.200, 0.200, 0.133, and 0.067.

### Self-Study 6.1. Time Series Decomposition

#### Self-Study 6.1 – Task 1: Classical Decomposition

Consider the last five years of the Gas data from aus_production:

```{r}
gas <- tail(aus_production, 5*4) |> select(Gas)
```

a\) Plot the time series. Can you identify seasonal fluctuations and/or a trend-cycle?

b\) Use classical_decomposition with type=multiplicative to calculate the trend-cycle and seasonal indices. Do the results support the graphical interpretation from part a?

c\) Compute and plot the seasonally adjusted data.

d\) Change one observation to be an outlier (e.g., add 300 to one observation), and recompute the seasonally adjusted data. What is the effect of the outlier?

-   Hint: Use, e.g., mutate(Gas = if_else(Quarter == yearquarter("2007Q4"), Gas + 300, Gas))

e\) Does it make any difference if the outlier is near the end rather than in the middle of the time series?

#### Self-Study 6.1 – Task 2: STL Decomposition

The following figures show the result of STL-decomposing the number of persons in the civilian labour force in Australia each month from February 1978 to August 1995.

![](Materials%20L6/Selfstudy%206.2.PNG)

a)  Write about 3–5 sentences describing the results of the decomposition. Pay particular attention to the scales of the graphs in making your interpretation.
b)  Is the recession of 1991/1992 visible in the estimated components?

## 6.2 Time Series Features

### Exercise 6.2. Time Series Features

#### Exercise 6.2: Analysing a Feature Plot Matrix

Use GGally::ggpairs() to look at the relationships between the STL-based features for the holiday series in the tourism data.

-   Hint: Change seasonal_peak_year and seasonal_trough_year to factors, as shown in the code to the lecture.

Which is the peak quarter for holidays in each state?

### Self-Study 6.2. Time Series Features

### Self-Study 6.2: Outlying Time Series

Use a feature-based approach to look for outlying series in the PBS data from package tsibbledata.

What is unusual about the series you identify as “outliers”.
